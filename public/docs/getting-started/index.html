<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width"><title>Getting Started | Lightweight Search Engine</title><link rel=stylesheet href=/hugo-lightweight-search/css/main.min.73be4799b2091d293b47b52ca2642fe82aa2b1c9c050e8d1b389a80939a30dd4.css integrity="sha256-c75HmbIJHSk7R7UsomQv6CqiscnAUOjRs4moCTmjDdQ=" crossorigin=anonymous><script src=/hugo-lightweight-search/js/main.23cd0c7d837263b9eaeb96ee2d9ccfa2969daa3fa00fa1c1fe8701a9b87251a1.js integrity="sha256-I80MfYNyY7nq65buLZzPopadqj+gD6HB/ocBqbhyUaE=" crossorigin=anonymous></script></head><body><header><h1>Lightweight Search Engine</h1><nav><ul><li><a href=/hugo-lightweight-search/>Home</a></li><li><a href=/hugo-lightweight-search/docs/>Documentation</a></li><li><a href=/hugo-lightweight-search/posts/>Blog</a></li><li><a href=/hugo-lightweight-search/pages/about/>About</a></li><li><a href=/hugo-lightweight-search/pages/search/>Search</a></li></ul></nav></header><main><h1>Getting Started</h1><time datetime=2025-10-06T00:00:00+00:00>October 6, 2025</time><h1 id=getting-started>Getting Started</h1><p>Get Hugo Lightweight Search up and running on your site in under 10 minutes. This guide covers the complete setup of a PHP-powered search engine using Hugo, SQLite FTS5, and a JavaScript frontend.</p><h2 id=what-youll-build>What You&rsquo;ll Build</h2><p>A fast, server-side search engine that:</p><ul><li>Indexes your Hugo content automatically during build</li><li>Uses SQLite FTS5 for powerful full-text search with stemming</li><li>Provides a REST API for searching</li><li>Includes a ready-to-use search page with JavaScript client</li></ul><h2 id=prerequisites>Prerequisites</h2><p>Before you begin, ensure you have:</p><ul><li><strong>Hugo</strong> (any recent version) - <a href=https://gohugo.io/installation/>Install Hugo</a></li><li><strong>PHP 7.4+</strong> with SQLite3 extension enabled</li><li><strong>SQLite3</strong> command-line tools (optional, for debugging)</li><li><strong>Web server</strong> with PHP support (Apache, Nginx, or PHP built-in server for local development)</li></ul><h3 id=verify-prerequisites>Verify Prerequisites</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Check Hugo</span>
</span></span><span style=display:flex><span>hugo version
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Check PHP version and SQLite extension</span>
</span></span><span style=display:flex><span>php -v
</span></span><span style=display:flex><span>php -m | grep sqlite3
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Check SQLite (optional)</span>
</span></span><span style=display:flex><span>sqlite3 --version
</span></span></code></pre></div><h2 id=installation>Installation</h2><h3 id=step-1-copy-files-to-your-hugo-site>Step 1: Copy Files to Your Hugo Site</h3><p>Copy the following files from this repository to your Hugo site:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Required files structure:</span>
</span></span><span style=display:flex><span>your-hugo-site/
</span></span><span style=display:flex><span>├── layouts/
</span></span><span style=display:flex><span>│   ├── _default/
</span></span><span style=display:flex><span>│   │   └── search-data.json       <span style=color:#75715e># JSON output template</span>
</span></span><span style=display:flex><span>│   └── page/
</span></span><span style=display:flex><span>│       └── search.html             <span style=color:#75715e># Search page template</span>
</span></span><span style=display:flex><span>├── scripts/
</span></span><span style=display:flex><span>│   └── build-search-index.php      <span style=color:#75715e># Index builder script</span>
</span></span><span style=display:flex><span>├── static/
</span></span><span style=display:flex><span>│   └── api/
</span></span><span style=display:flex><span>│       └── search.php              <span style=color:#75715e># Search API endpoint</span>
</span></span><span style=display:flex><span>├── content/
</span></span><span style=display:flex><span>│   └── search.md                   <span style=color:#75715e># Search page content</span>
</span></span><span style=display:flex><span>└── build.sh                 <span style=color:#75715e># Build automation script</span>
</span></span></code></pre></div><h4 id=create-the-json-output-template>Create the JSON Output Template</h4><p>Create <code>/layouts/_default/search-data.json</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go-template data-lang=go-template><span style=display:flex><span><span style=color:#75715e>{{-</span> <span style=color:#a6e22e>$pages</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>where</span> <span style=color:#a6e22e>site</span><span style=color:#a6e22e>.RegularPages</span> <span style=color:#e6db74>&#34;Type&#34;</span> <span style=color:#e6db74>&#34;!=&#34;</span> <span style=color:#e6db74>&#34;page&#34;</span> <span style=color:#75715e>-}}</span>
</span></span><span style=display:flex><span><span style=color:#75715e>{{-</span> <span style=color:#a6e22e>$pages</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>where</span> <span style=color:#a6e22e>$pages</span> <span style=color:#e6db74>&#34;Draft&#34;</span> <span style=color:#e6db74>&#34;!=&#34;</span> <span style=color:#66d9ef>true</span> <span style=color:#75715e>-}}</span>
</span></span><span style=display:flex><span><span style=color:#75715e>{{-</span> <span style=color:#a6e22e>$pages</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>where</span> <span style=color:#a6e22e>$pages</span> <span style=color:#e6db74>&#34;Params.search&#34;</span> <span style=color:#e6db74>&#34;!=&#34;</span> <span style=color:#66d9ef>false</span> <span style=color:#75715e>-}}</span>
</span></span><span style=display:flex><span>[
</span></span><span style=display:flex><span><span style=color:#75715e>{{-</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>$index</span><span style=color:#f92672>,</span> <span style=color:#a6e22e>$page</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>$pages</span> <span style=color:#75715e>-}}</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>{{-</span> <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>$index</span> <span style=color:#75715e>}}</span>,<span style=color:#75715e>{{</span> <span style=color:#66d9ef>end</span> <span style=color:#75715e>}}</span>
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    &#34;id&#34;: <span style=color:#75715e>{{</span> <span style=color:#a6e22e>$page</span><span style=color:#a6e22e>.File.UniqueID</span> <span style=color:#f92672>|</span> <span style=color:#a6e22e>jsonify</span> <span style=color:#75715e>}}</span>,
</span></span><span style=display:flex><span>    &#34;title&#34;: <span style=color:#75715e>{{</span> <span style=color:#a6e22e>$page</span><span style=color:#a6e22e>.Title</span> <span style=color:#f92672>|</span> <span style=color:#a6e22e>jsonify</span> <span style=color:#75715e>}}</span>,
</span></span><span style=display:flex><span>    &#34;url&#34;: <span style=color:#75715e>{{</span> <span style=color:#a6e22e>$page</span><span style=color:#a6e22e>.Permalink</span> <span style=color:#f92672>|</span> <span style=color:#a6e22e>jsonify</span> <span style=color:#75715e>}}</span>,
</span></span><span style=display:flex><span>    &#34;content&#34;: <span style=color:#75715e>{{</span> <span style=color:#a6e22e>$page</span><span style=color:#a6e22e>.Plain</span> <span style=color:#f92672>|</span> <span style=color:#a6e22e>jsonify</span> <span style=color:#75715e>}}</span>,
</span></span><span style=display:flex><span>    &#34;summary&#34;: <span style=color:#75715e>{{</span> <span style=color:#a6e22e>$page</span><span style=color:#a6e22e>.Summary</span> <span style=color:#f92672>|</span> <span style=color:#a6e22e>jsonify</span> <span style=color:#75715e>}}</span>,
</span></span><span style=display:flex><span>    &#34;date&#34;: <span style=color:#75715e>{{</span> <span style=color:#a6e22e>$page</span><span style=color:#a6e22e>.Date.Format</span> <span style=color:#e6db74>&#34;2006-01-02&#34;</span> <span style=color:#f92672>|</span> <span style=color:#a6e22e>jsonify</span> <span style=color:#75715e>}}</span>,
</span></span><span style=display:flex><span>    &#34;section&#34;: <span style=color:#75715e>{{</span> <span style=color:#a6e22e>$page</span><span style=color:#a6e22e>.Section</span> <span style=color:#f92672>|</span> <span style=color:#a6e22e>jsonify</span> <span style=color:#75715e>}}</span>,
</span></span><span style=display:flex><span>    &#34;tags&#34;: <span style=color:#75715e>{{</span> <span style=color:#a6e22e>$page</span><span style=color:#a6e22e>.Params.tags</span> <span style=color:#f92672>|</span> <span style=color:#a6e22e>jsonify</span> <span style=color:#75715e>}}</span>,
</span></span><span style=display:flex><span>    &#34;categories&#34;: <span style=color:#75715e>{{</span> <span style=color:#a6e22e>$page</span><span style=color:#a6e22e>.Params.categories</span> <span style=color:#f92672>|</span> <span style=color:#a6e22e>jsonify</span> <span style=color:#75715e>}}</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span><span style=color:#75715e>{{-</span> <span style=color:#66d9ef>end</span> <span style=color:#75715e>-}}</span>
</span></span><span style=display:flex><span>]
</span></span></code></pre></div><h4 id=create-the-search-page-content>Create the Search Page Content</h4><p>Create <code>/content/search.md</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>---
</span></span><span style=display:flex><span>title: &#34;Search&#34;
</span></span><span style=display:flex><span>layout: &#34;search&#34;
</span></span><span style=display:flex><span>---
</span></span></code></pre></div><h3 id=step-2-configure-hugo-for-json-output>Step 2: Configure Hugo for JSON Output</h3><p>Add JSON output format to your <code>hugo.yaml</code> (or <code>config.toml</code>):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>outputs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>home</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>HTML</span>
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>RSS</span>
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>JSON</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>outputFormats</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>JSON</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>baseName</span>: <span style=color:#ae81ff>index</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>isPlainText</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>mediaType</span>: <span style=color:#ae81ff>application/json</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>notAlternative</span>: <span style=color:#66d9ef>true</span>
</span></span></code></pre></div><p>This configures Hugo to generate <code>/index.json</code> with your site&rsquo;s searchable content.</p><h3 id=step-3-copy-php-scripts>Step 3: Copy PHP Scripts</h3><h4 id=index-builder-script>Index Builder Script</h4><p>Copy <code>/scripts/build-search-index.php</code> - this script:</p><ul><li>Reads Hugo&rsquo;s generated JSON</li><li>Creates SQLite database with FTS5 tables</li><li>Populates the search index</li><li>Optimizes the database</li></ul><h4 id=search-api>Search API</h4><p>Copy <code>/static/api/search.php</code> - this provides:</p><ul><li>RESTful search endpoint at <code>/api/search.php</code></li><li>Advanced query parsing (phrases, field searches, date filters)</li><li>BM25 ranking with relevance scoring</li><li>Pagination support</li></ul><h3 id=step-4-copy-search-page-template>Step 4: Copy Search Page Template</h3><p>Copy <code>/layouts/page/search.html</code> - includes:</p><ul><li>Search input with live search</li><li>Section filtering</li><li>Sort options (relevance, date)</li><li>JavaScript client for API interaction</li><li>Advanced search syntax documentation</li></ul><h3 id=step-5-create-build-script>Step 5: Create Build Script</h3><p>Create <code>/build.sh</code> at your Hugo root:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e># Hugo Search Build Script</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Builds Hugo site and creates SQLite search index</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>set -e  <span style=color:#75715e># Exit on any error</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;Building Hugo site with search...&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Build Hugo site</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;Building Hugo site...&#34;</span>
</span></span><span style=display:flex><span>hugo --minify
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Find the generated search data file</span>
</span></span><span style=display:flex><span>SEARCH_DATA_FILE<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;public/index.json&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> ! -f <span style=color:#e6db74>&#34;</span>$SEARCH_DATA_FILE<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;Error: Search data not generated. Check your Hugo configuration.&#34;</span>
</span></span><span style=display:flex><span>    exit <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;Hugo build complete&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;Found search data: </span>$SEARCH_DATA_FILE<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Build search database</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;Building search database...&#34;</span>
</span></span><span style=display:flex><span>php scripts/build-search-index.php public/search.db <span style=color:#e6db74>&#34;</span>$SEARCH_DATA_FILE<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;Search database created&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Set proper permissions for web server</span>
</span></span><span style=display:flex><span>chmod <span style=color:#ae81ff>644</span> public/search.db
</span></span><span style=display:flex><span>chmod <span style=color:#ae81ff>755</span> public/api/search.php
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;Build complete!&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;Search Engine:&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;   Database: public/search.db&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;   API endpoint: /api/search.php&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;   Search page: /search/&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;Ready to deploy!&#34;</span>
</span></span></code></pre></div><p>Make it executable:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>chmod +x build.sh
</span></span></code></pre></div><h2 id=building-the-search-index>Building the Search Index</h2><h3 id=initial-build>Initial Build</h3><p>Run the build script:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./build.sh
</span></span></code></pre></div><p>This will:</p><ol><li>Build your Hugo site with <code>hugo --minify</code></li><li>Generate <code>/public/index.json</code> with searchable content</li><li>Create <code>/public/search.db</code> SQLite database with FTS5 index</li><li>Set proper file permissions</li></ol><h3 id=manual-build-alternative>Manual Build (Alternative)</h3><p>If you prefer manual steps:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 1. Build Hugo site</span>
</span></span><span style=display:flex><span>hugo --minify
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2. Build search index</span>
</span></span><span style=display:flex><span>php scripts/build-search-index.php public/search.db public/index.json
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 3. Set permissions</span>
</span></span><span style=display:flex><span>chmod <span style=color:#ae81ff>644</span> public/search.db
</span></span><span style=display:flex><span>chmod <span style=color:#ae81ff>755</span> public/api/search.php
</span></span></code></pre></div><h3 id=rebuild-after-content-changes>Rebuild After Content Changes</h3><p>Whenever you update your content, rebuild the search index:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./build.sh
</span></span></code></pre></div><p>The script will rebuild everything from scratch, ensuring your search index stays in sync with your content.</p><h2 id=testing-locally>Testing Locally</h2><h3 id=option-1-php-built-in-server>Option 1: PHP Built-in Server</h3><p>Start PHP&rsquo;s built-in server from your <code>public</code> directory:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd public
</span></span><span style=display:flex><span>php -S localhost:8080
</span></span></code></pre></div><p>Then visit:</p><ul><li>Site: http://localhost:8080</li><li>Search page: http://localhost:8080/search/</li><li>API test: http://localhost:8080/api/search.php?q=test</li></ul><h3 id=option-2-hugo-server-with-php>Option 2: Hugo Server with PHP</h3><p>Run Hugo&rsquo;s development server alongside PHP:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Terminal 1: Hugo server</span>
</span></span><span style=display:flex><span>hugo server
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Terminal 2: PHP server for API</span>
</span></span><span style=display:flex><span>cd public
</span></span><span style=display:flex><span>php -S localhost:8081
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Configure your search page to use localhost:8081 for API calls during development</span>
</span></span></code></pre></div><h3 id=testing-the-search-api>Testing the Search API</h3><p>Test the API directly:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Basic search</span>
</span></span><span style=display:flex><span>curl <span style=color:#e6db74>&#34;http://localhost:8080/api/search.php?q=getting+started&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Search with section filter</span>
</span></span><span style=display:flex><span>curl <span style=color:#e6db74>&#34;http://localhost:8080/api/search.php?q=hugo&amp;section=docs&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Phrase search</span>
</span></span><span style=display:flex><span>curl <span style=color:#e6db74>&#34;http://localhost:8080/api/search.php?q=\&#34;getting+started\&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Field-specific search</span>
</span></span><span style=display:flex><span>curl <span style=color:#e6db74>&#34;http://localhost:8080/api/search.php?q=title:search&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Date range search</span>
</span></span><span style=display:flex><span>curl <span style=color:#e6db74>&#34;http://localhost:8080/api/search.php?q=hugo+after:2024-01-01&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Get available sections</span>
</span></span><span style=display:flex><span>curl <span style=color:#e6db74>&#34;http://localhost:8080/api/search.php?action=sections&#34;</span>
</span></span></code></pre></div><h2 id=deployment>Deployment</h2><h3 id=deploy-to-production-server>Deploy to Production Server</h3><ol><li><strong>Build locally</strong> with production settings:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Update baseURL in hugo.yaml first</span>
</span></span><span style=display:flex><span>hugo --minify
</span></span><span style=display:flex><span>php scripts/build-search-index.php public/search.db public/index.json
</span></span></code></pre></div><ol start=2><li><strong>Upload the <code>public</code> directory</strong> to your web server:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Example using rsync</span>
</span></span><span style=display:flex><span>rsync -avz --delete public/ user@yourserver.com:/var/www/html/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Or using FTP/SFTP client</span>
</span></span></code></pre></div><ol start=3><li><strong>Verify permissions</strong> on the server:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>chmod <span style=color:#ae81ff>644</span> /var/www/html/search.db
</span></span><span style=display:flex><span>chmod <span style=color:#ae81ff>644</span> /var/www/html/api/search.php
</span></span></code></pre></div><h3 id=web-server-configuration>Web Server Configuration</h3><h4 id=apache>Apache</h4><p>No special configuration needed. The <code>.php</code> files will be processed automatically if <code>mod_php</code> or PHP-FPM is configured.</p><p>Optional <code>.htaccess</code> for cleaner URLs:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-apache data-lang=apache><span style=display:flex><span>RewriteEngine <span style=color:#66d9ef>On</span>
</span></span><span style=display:flex><span>RewriteRule ^search$ <span style=color:#e6db74>/search/</span> [R=301,L]
</span></span></code></pre></div><h4 id=nginx>Nginx</h4><p>Add PHP processing to your server block:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>server</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_name</span> <span style=color:#e6db74>yoursite.com</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>root</span> <span style=color:#e6db74>/var/www/html</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>index</span> <span style=color:#e6db74>index.html</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># PHP processing for search API
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>location</span> ~ <span style=color:#e6db74>\.php$</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>fastcgi_pass</span> <span style=color:#e6db74>unix:/var/run/php/php7.4-fpm.sock</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>fastcgi_index</span> <span style=color:#e6db74>index.php</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>include</span> <span style=color:#e6db74>fastcgi_params</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>fastcgi_param</span> <span style=color:#e6db74>SCRIPT_FILENAME</span> $document_root$fastcgi_script_name;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Hugo static files
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>location</span> <span style=color:#e6db74>/</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>try_files</span> $uri $uri/ =<span style=color:#ae81ff>404</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=cicd-integration>CI/CD Integration</h3><h4 id=github-actions-example>GitHub Actions Example</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>Build and Deploy</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>push</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>branches</span>: [<span style=color:#ae81ff>main]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>build</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Setup Hugo</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>peaceiris/actions-hugo@v2</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>hugo-version</span>: <span style=color:#e6db74>&#39;latest&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Build site and search index</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>run</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          chmod +x build.sh
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          ./build.sh</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Deploy</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>run</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          rsync -avz --delete public/ ${{ secrets.DEPLOY_USER }}@${{ secrets.DEPLOY_HOST }}:${{ secrets.DEPLOY_PATH }}</span>
</span></span></code></pre></div><h2 id=troubleshooting>Troubleshooting</h2><h3 id=search-returns-no-results>Search Returns No Results</h3><p><strong>Problem</strong>: Search API returns empty results or errors.</p><p><strong>Solutions</strong>:</p><ol><li>Verify database exists: <code>ls -lh public/search.db</code></li><li>Check database content: <code>sqlite3 public/search.db "SELECT COUNT(*) FROM search_content;"</code></li><li>Verify JSON was generated: <code>ls -lh public/index.json</code></li><li>Check PHP error logs: <code>tail -f /var/log/php-errors.log</code></li><li>Test API directly: <code>curl "http://localhost:8080/api/search.php?q=test"</code></li></ol><h3 id=database-file-not-found>Database File Not Found</h3><p><strong>Problem</strong>: <code>search.db</code> not created or missing.</p><p><strong>Solutions</strong>:</p><ol><li>Ensure PHP has SQLite extension: <code>php -m | grep sqlite3</code></li><li>Check file permissions in <code>public</code> directory</li><li>Run build script with verbose output: <code>bash -x build.sh</code></li><li>Manually run PHP script: <code>php scripts/build-search-index.php public/search.db public/index.json</code></li></ol><h3 id=json-not-generated>JSON Not Generated</h3><p><strong>Problem</strong>: <code>index.json</code> not created by Hugo.</p><p><strong>Solutions</strong>:</p><ol><li>Verify Hugo config has JSON output format (see Step 2)</li><li>Check template exists: <code>layouts/_default/search-data.json</code></li><li>Build with verbose: <code>hugo --verbose</code></li><li>Check for template errors in Hugo output</li></ol><h3 id=permission-denied-errors>Permission Denied Errors</h3><p><strong>Problem</strong>: Web server cannot read database or execute PHP.</p><p><strong>Solutions</strong>:</p><ol><li>Set correct permissions:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>chmod <span style=color:#ae81ff>644</span> public/search.db
</span></span><span style=display:flex><span>chmod <span style=color:#ae81ff>755</span> public/api/search.php
</span></span></code></pre></div></li><li>Check web server user owns files: <code>chown www-data:www-data public/search.db</code></li><li>Verify SELinux context if on RHEL/CentOS: <code>chcon -R -t httpd_sys_content_t public/</code></li></ol><h3 id=search-query-syntax-not-working>Search Query Syntax Not Working</h3><p><strong>Problem</strong>: Advanced search features (phrases, field searches) don&rsquo;t work.</p><p><strong>Solutions</strong>:</p><ol><li>Check query encoding in URLs (spaces should be <code>+</code> or <code>%20</code>)</li><li>Escape quotes properly: <code>q="exact phrase"</code> → <code>q=%22exact%20phrase%22</code></li><li>Verify FTS5 is enabled: <code>sqlite3 public/search.db "SELECT * FROM search_fts LIMIT 1;"</code></li><li>Review search.php logs for query parsing errors</li></ol><h3 id=slow-search-performance>Slow Search Performance</h3><p><strong>Problem</strong>: Search takes too long to return results.</p><p><strong>Solutions</strong>:</p><ol><li>Ensure FTS5 index is optimized (build script does this automatically)</li><li>Limit result size with <code>&amp;limit=10</code> parameter</li><li>Check database size: <code>ls -lh public/search.db</code></li><li>Consider splitting large sites into section-specific indexes</li><li>Enable PHP opcache for better performance</li></ol><h3 id=build-script-fails>Build Script Fails</h3><p><strong>Problem</strong>: <code>build.sh</code> exits with errors.</p><p><strong>Solutions</strong>:</p><ol><li>Check Hugo is installed: <code>hugo version</code></li><li>Verify PHP is installed: <code>php -v</code></li><li>Ensure script is executable: <code>chmod +x build.sh</code></li><li>Run with debugging: <code>bash -x build.sh</code></li><li>Check disk space: <code>df -h</code></li></ol><h2 id=next-steps>Next Steps</h2><p>Now that your search is working:</p><ol><li><strong>Customize the search page</strong> - Edit <code>/layouts/page/search.html</code> to match your site&rsquo;s design</li><li><strong>Configure search behavior</strong> - Modify <code>/static/api/search.php</code> for custom ranking or filters</li><li><strong>Exclude pages from search</strong> - Add <code>search: false</code> to page front matter</li><li><strong>Add search to navigation</strong> - Link to <code>/search/</code> from your main menu</li><li><strong>Monitor performance</strong> - Check database size and query performance as content grows</li></ol><h2 id=advanced-features>Advanced Features</h2><p>The implementation includes powerful features out of the box:</p><ul><li><strong>Porter Stemming</strong>: Automatically matches word variants (searching &ldquo;run&rdquo; finds &ldquo;running&rdquo;, &ldquo;runs&rdquo;)</li><li><strong>BM25 Ranking</strong>: Advanced relevance scoring that considers term frequency and document length</li><li><strong>Field Weighting</strong>: Title matches ranked higher than content matches</li><li><strong>Phrase Search</strong>: Use quotes for exact matches: <code>"getting started"</code></li><li><strong>Field-Specific Search</strong>: Target specific fields: <code>title:hugo</code>, <code>tags:tutorial</code></li><li><strong>Date Filtering</strong>: Filter by date: <code>after:2024-01-01</code>, <code>before:2024-12-31</code></li><li><strong>Boolean Operators</strong>: Use OR for alternatives: <code>hugo OR jekyll</code></li><li><strong>Fuzzy Matching</strong>: Automatic prefix matching for partial terms</li></ul><h2 id=performance-characteristics>Performance Characteristics</h2><p>Typical performance metrics:</p><ul><li><strong>Index Build Time</strong>: ~0.1-0.5 seconds per 100 pages</li><li><strong>Database Size</strong>: ~50-200 KB per 100 pages (highly compressed with FTS5)</li><li><strong>Search Query Time</strong>: &lt;50ms for most queries on databases with 1000+ pages</li><li><strong>Memory Usage</strong>: Minimal - SQLite loads only required data</li></ul><p>This makes it suitable for sites ranging from small blogs to large documentation sites with thousands of pages.</p></main><footer><p>Copyright 2025. All rights reserved.</p></footer></body></html>